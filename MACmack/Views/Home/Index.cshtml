@model MACmack.Models.ServiceTypeViewModel
@{
    ViewData["Title"] = "MAConomen anställda";
}

<div class="boxcontainer container">
    <table id="myTable">
        <tr>
            <th>Regnr</th>
            <th>ServiceType</th>
            <th>Status</th>
            <th>Ändra</th>
        </tr>
    </table>
</div>


@*<script>
        $(document).ready(function () {
            var ws = new WebSocket("ws://127.0.0.1:8000/mac")
            ws.onopen = function () {

                var btn = document.getElementById("send");

                btn.addEventListener('click', function () {

                    var message = {
                        serviceTypes: document.getElementById("serviceId").value,
                        regNumber: document.getElementById("regNumber").value
                    };
                    $('#regModal').modal('toggle');
                    ws.send(JSON.stringify(message));
                    ws.close();
                })
            }
        });
    </script>*@

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

<script>
    $(document).ready(function () {
        var ws = new WebSocket("ws://127.0.0.1:8000/employee")
        alert("Document ready");
        ws.onopen = function () {
            alert("Onopen!");

        }

        ws.onmessage = function (evt) {
            alert("onmessage!");
            var rec = evt.data;

            alert("evt : " + rec);
            console.log(rec);

            var splitArray = rec.split(',');

            var regnr = splitArray[0];
            var serviceType = splitArray[1];
            var status = "Ny!";

            var table = document.getElementById("myTable");

            var row = table.insertRow(1);

            var cell1 = row.insertCell(0);
            var cell2 = row.insertCell(1);
            var cell3 = row.insertCell(2);
            var cell4 = row.insertCell(2);

            cell1.innerHTML = regnr;
            cell2.innerHTML = serviceType;
            cell3.innerHTML = status;
            cell4.innerHTML = "<button class='statusButton' id=`${regnr}`>Redo!</button>";
        }
    })

    var buttons = document.getElementsByClassName('statusButton');
    var buttonArray = [...buttons];

    for (var i = 0; i > buttonArray.length; i++) {

        buttonArray[i].addEventListener('click', function () {


            //Switch status in table
            //Send status to server
            this.id;

            var message = "`$this.id`,klar";



        })
    }

</script>

